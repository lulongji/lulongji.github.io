---
layout:     post
title:      interview 
subtitle:   interview
date:       2015-11-28
author:     lulongji
header-img: img/post-bg-2015.jpg
catalog: true
tags:
    - interview
---

# 概念问题

1. 什么是微服务？
>  根据业务或者是维度拆分的单个服务、每个服务都可以独立运行！

2. 微服务之间如何独立通信的？
> 主要分为两种模式、同步模式和异步模式。  同步一般是RPC、REST等。  异步一般是消息队列。

3. 消息队列中间件如何选择？
> 消息协议、是否支持持久化、吞吐量高可用和扩展能力、社区是否成熟、是否易于开发等

4. springcloud和dubbo有哪些区别？
> 1. 协议不同：dubbo是基于RPC远程调用，springcloud是基于http的rest api调用
> 2. springcloud 属于全家桶现成模式、而dubbo是需要根据自己需求去组装的。所以使用dubbo必须对其兼容性和稳定型有一定的了解吧！

5. springboot 和springcloud的理解？
> 1. springboot 是spring的快速整合的框架、属于微观个体服务。
> 2. springcloud 是spring的全局服务协调治理、管理着每个springboot单体服务、属于宏观框架。

6. 什么是熔断？
> 由于一些原因导致服务过载、为了防止系统故障采取的一种保护措施。
> hystrix 断路由、在分布式服务中许多依赖遇到超时、异常等情况、hystrix能够保证整个系统正常运行、不雪崩避免级联故障。

7. 什么是服务降级？
> 就是说在服务资源不够的情况下、关闭掉一些服务、待资源充足在启动。

8. CAP 定理？
> Consistency 一致性  Availvability 可用性  Partition tolerance 分区容错性

9. eureka和zookeeper的区别！
> 1. eurka是AP 、zookeeper是CP
> 2. zookeeper 对一致性要求很高、可以容忍注册信息是旧的、但不允许挂掉！当一个zookeeper挂掉、那么其他的zookeeper会进行一次选举、在此期间zookeeper是不可用的。
> 3. eureka 在设计的时候优先保证可用性、所以挂掉挂掉几个节点不会影响正常工作、剩余节点依然可以提供注册和查询服务。




# 细节问题

1. 脑裂问题
> 

2. redis分布式锁的问题
> setIfAbsent 的使用：
>> 分布式服务中、当坐席或者用户会话超时（超时检测机制、定时任务查询redis 使用setnx加锁，避免重复执行）
>> 当机器人超时关闭检测等、或者通知类的消息检测

3. redis中数据筛选查询问题：
> scan 的使用：在巨大的数据量的情况下，做类似于查找符合某种规则的Key的信息，这里就有两种方式。
>> 一是keys命令，简单粗暴，由于Redis单线程这一特性，keys命令是以阻塞的方式执行的，keys是以遍历的方式实现的复杂度是 O(n），Redis库中的key越多，查找实现代价越大，产生的阻塞时间越长。
>> 二是scan命令，以非阻塞的方式实现key值的查找，绝大多数情况下是可以替代keys命令的，可选性更强。
>>> 场景: 筛选所有未过期的redis数据进行数据通知等。

4. 锁
> CAS和ABA的问题：
>> 什么是CAS：
>>> Compare and Swap.  CAS 有三个操作数、内存值V 和旧的预期值A，要修改的新值B。当且仅当内存值V与预期值A相同时，将V值修改成B值，否则什么都不做。
>>> 以上就会导致ABA的问题。如：一个单向链表，栈顶是A，这时线程T1是知道A.next为B的，然后希望用CAS将栈顶替换为B：head.compareAndSet(A,B);```在线程T1执行之前、线程T2介入、将A、B出栈```在push进去D、C、A，此时对象B就处在游离状态了、```此时轮到T1执行CAS、检测的时候会发现、栈顶仍然是A、所以CAS成功、栈顶就变为B，但是实际上是B.next为null，这样就把CD也丢掉了！```





