---
layout:     post
title:      Question
subtitle:   Question
date:       2019-09-26
author:     lulongji
header-img: img/post-bg-hacker.jpg
catalog: true
tags:
    - question
---

# 说明
这么多年的研发生涯中遇到过很多问题、但是几乎都没有记录下来、所以从今天开始、把遇到的问题及处理的方式做个总结。

# 问题及解决办法

### 脚本启动无日志无反应

- 排查原因：发现脚本开启debug模式、启动的时候debug 端口被占用导致、无法启动且日志被屏蔽！

### websocket有部分浏览器不兼容问题

- 问题分析：目前用户侧和坐席侧双方都为websocket服务、但用户侧浏览器不固定需要处理兼容性问题、所以增加cometserver的http方式向下兼容、保证移动端和pc端浏览器在不支持webscoket的情况下可以处理相应会话。
- 解决问题：增加cometserver服务、利用DeferredResult属性充分利用http资源做http长轮询处理！

### 近期websocket 连接总会在1分钟之后默认断开连接、发起重连机制（很频繁）

- 排查问题：发现在ngixn做处理的时候超时时间太短、导致websocket在1分钟超时自动断开、所以websocket的重连机制才会频繁发起

- 解决方案：增加nginx的超时时间 `proxy_read_timeout `

        location /websocket {
            proxy_pass http://websocket;
            proxy_http_version 1.1;
            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection $connection_upgrade;
            proxy_read_timeout          600s;
        }



# 声明
本文只做学习参考，如有任何问题的地方欢迎指正。

我的邮箱：
- ```lulongji2011@163.com```